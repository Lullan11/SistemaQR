<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generar QR de Producto</title>
  <!-- Firebase v10 modular -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
</head>
<body>
  <h1>Generar QR de Producto</h1>
  
  <button id="btnGenerar">Generar QR</button>
  <div id="qrcode"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // === CONFIGURAR FIREBASE ===
    const firebaseConfig = {
      apiKey: "AIzaSyAgBzytpIzLrz-TR04k_v7i2DLbYkPFZVE",
      authDomain: "qrcode-666ce.firebaseapp.com",
      projectId: "qrcode-666ce",
      storageBucket: "qrcode-666ce.firebasestorage.app",
      messagingSenderId: "721295004839",
      appId: "1:721295004839:web:ec696403ad909ebfc13782"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // === FUNCIÓN PARA CREAR QR ===
    document.getElementById("btnGenerar").addEventListener("click", async () => {
      try {
        // Id de un documento existente en tu colección productos
        const idDoc = "BbFEtT5nPnNyvTkHoP6h";

        const docRef = doc(db, "productos", idDoc);
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
          const data = docSnap.data();
          const mensaje = `Producto: ${data.nombre}\nPrecio: $${data.precio}\n${data.descripcion}`;

          document.getElementById("qrcode").innerHTML = "";
          new QRCode(document.getElementById("qrcode"), {
            text: mensaje,
            width: 200,
            height: 200
          });
        } else {
          alert("El documento no existe");
        }
      } catch (error) {
        console.error("Error obteniendo documento:", error);
      }
    });
  </script>
</body>
</html>
